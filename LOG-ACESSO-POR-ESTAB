SELECT	C.CD_EMPRESA AS COD_EMPRESA,
		C.CD_BASE_CGC AS CNPJ_ESTABELECIMENTO,
		C.NM_RAZAO_SOCIAL AS NOME_EMPRESA,
		B.CD_ESTABELECIMENTO AS COD_ESTABELECIMENTO,
		B.CD_CGC AS CNPJ_ESTABELECIMENTO,
		OBTER_NOME_PJ(B.CD_CGC) AS NOME_ESTABELECIMENTO ,
		COUNT(A.NR_SEQUENCIA) AS TOTAL_ACESSOS
FROM	LOG_ACESSO_FUNCAO A,
		ESTABELECIMENTO B,
		EMPRESA C
WHERE   A.CD_ESTABELECIMENTO = B.CD_ESTABELECIMENTO
AND     B.CD_EMPRESA = C.CD_EMPRESA
AND     A.DT_ACESSO >= SYSDATE-180
GROUP BY	C.CD_EMPRESA,
			C.CD_BASE_CGC,
			C.NM_RAZAO_SOCIAL,
			B.CD_ESTABELECIMENTO,
			B.CD_CGC



